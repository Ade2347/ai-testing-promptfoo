'use strict';

var zod = require('zod');
var provider = require('@adaline/provider');
var types = require('@adaline/types');

var ot=Object.defineProperty,tt=Object.defineProperties;var nt=Object.getOwnPropertyDescriptors;var co=Object.getOwnPropertySymbols;var it=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable;var X=(s,e)=>(e=Symbol[s])?e:Symbol.for("Symbol."+s),at=s=>{throw TypeError(s)};var go=(s,e,t)=>e in s?ot(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,T=(s,e)=>{for(var t in e||(e={}))it.call(e,t)&&go(s,t,e[t]);if(co)for(var t of co(e))st.call(e,t)&&go(s,t,e[t]);return s},U=(s,e)=>tt(s,nt(e));var R=(s,e,t)=>new Promise((o,n)=>{var a=m=>{try{i(t.next(m));}catch(r){n(r);}},l=m=>{try{i(t.throw(m));}catch(r){n(r);}},i=m=>m.done?o(m.value):Promise.resolve(m.value).then(a,l);i((t=t.apply(s,e)).next());}),ho=function(s,e){this[0]=s,this[1]=e;},De=(s,e,t)=>{var o=(l,i,m,r)=>{try{var p=t[l](i),g=(i=p.value)instanceof ho,P=p.done;Promise.resolve(g?i[0]:i).then(f=>g?o(l==="return"?l:"next",i[1]?{done:f.done,value:f.value}:f,m,r):m({value:f,done:P})).catch(f=>o("throw",f,m,r));}catch(f){r(f);}},n=l=>a[l]=i=>new Promise((m,r)=>o(l,i,m,r)),a={};return t=t.apply(s,e),a[X("asyncIterator")]=()=>a,n("next"),n("throw"),n("return"),a},fo=s=>{var e=s[X("asyncIterator")],t=!1,o,n={};return e==null?(e=s[X("iterator")](),o=a=>n[a]=l=>e[a](l)):(e=e.call(s),o=a=>n[a]=l=>{if(t){if(t=!1,a==="throw")throw l;return l}return t=!0,{done:!1,value:new ho(new Promise(i=>{var m=e[a](l);m instanceof Object||at("Object expected"),i(m);}),1)}}),n[X("iterator")]=()=>n,o("next"),"throw"in e?o("throw"):n.throw=a=>{throw a},"return"in e&&o("return"),n};var Le=(s,e)=>provider.RangeConfigItem({param:"temperature",title:provider.CHAT_CONFIG.TEMPERATURE.title,description:provider.CHAT_CONFIG.TEMPERATURE.description,min:0,max:s,step:.01,default:e}),$e=s=>provider.RangeConfigItem({param:"maxOutputTokens",title:provider.CHAT_CONFIG.MAX_TOKENS.title,description:provider.CHAT_CONFIG.MAX_TOKENS.description,min:0,max:s,step:1,default:0}),Ue=s=>provider.MultiStringConfigItem({param:"stopSequences",title:provider.CHAT_CONFIG.STOP(s).title,description:provider.CHAT_CONFIG.STOP(s).description,max:s}),je=s=>provider.RangeConfigItem({param:"topP",title:provider.CHAT_CONFIG.TOP_P.title,description:provider.CHAT_CONFIG.TOP_P.description,min:0,max:1,step:.01,default:s}),En=s=>provider.RangeConfigItem({param:"topK",title:provider.CHAT_CONFIG.TOP_K.title,description:provider.CHAT_CONFIG.TOP_K.description,min:1,max:40,step:1,default:s}),Sn=provider.RangeConfigItem({param:"frequencyPenalty",title:provider.CHAT_CONFIG.FREQUENCY_PENALTY.title,description:provider.CHAT_CONFIG.FREQUENCY_PENALTY.description,min:-2,max:2,step:.01,default:0}),Rn=provider.RangeConfigItem({param:"presencePenalty",title:provider.CHAT_CONFIG.PRESENCE_PENALTY.title,description:provider.CHAT_CONFIG.PRESENCE_PENALTY.description,min:-2,max:2,step:.01,default:0}),On=provider.RangeConfigItem({param:"seed",title:provider.CHAT_CONFIG.SEED.title,description:provider.CHAT_CONFIG.SEED.description,min:0,max:1e6,step:1,default:0}),qe=provider.SelectStringConfigItem({param:"toolChoice",title:"Tool choice",description:"Controls which (if any) tool is called by the model. 'none' means the model will not call a function. 'auto' means the model can pick between generating a message or calling a tool.",default:"auto",choices:["auto","any","none"]}),Be=provider.ObjectSchemaConfigItem({param:"safetySettings",title:"Safety settings",description:"The safety rating contains the category of harm and the harm probability level in that category for a piece of content.",objectSchema:zod.z.array(zod.z.object({threshold:zod.z.enum(["HARM_BLOCK_THRESHOLD_UNSPECIFIED","BLOCK_LOW_AND_ABOVE","BLOCK_MEDIUM_AND_ABOVE","BLOCK_ONLY_HIGH","BLOCK_NONE","OFF"]),category:zod.z.enum(["HARM_CATEGORY_UNSPECIFIED","HARM_CATEGORY_HARASSMENT","HARM_CATEGORY_HATE_SPEECH","HARM_CATEGORY_SEXUALLY_EXPLICIT","HARM_CATEGORY_DANGEROUS_CONTENT","HARM_CATEGORY_CIVIC_INTEGRITY"])}))}),Ae=provider.SelectBooleanConfigItem({param:"reasoningEnabled",title:"Reasoning Enabled",description:"Controls whether the model is allowed to think for a longer period of time before generating a response. This can be useful for complex tasks that require more time to think.",default:!1});var Q=(s,e,t,o,n)=>zod.z.object({temperature:Le(s,e).schema,maxTokens:$e(t).schema,stop:Ue(o).schema,topP:je(n).schema,toolChoice:qe.schema,safetySettings:Be.schema}),ee=(s,e,t,o,n)=>({temperature:Le(s,e).def,maxTokens:$e(t).def,stop:Ue(o).def,topP:je(n).def,toolChoice:qe.def,safetySettings:Be.def});var uo=provider.ObjectSchemaConfigItem({param:"response_schema",title:provider.CHAT_CONFIG.RESPONSE_SCHEMA.title,description:provider.CHAT_CONFIG.RESPONSE_SCHEMA.description,objectSchema:types.ResponseSchema}),yo=provider.SelectStringConfigItem({param:"response_format",title:provider.CHAT_CONFIG.RESPONSE_FORMAT_WITH_SCHEMA.title,description:provider.CHAT_CONFIG.RESPONSE_FORMAT_WITH_SCHEMA.description,default:"text",choices:["text","json_schema"]}),te=(s,e,t,o,n)=>U(T({},ee(s,e,t,o,n)),{responseFormat:yo.def,responseSchema:uo.def}),ne=(s,e,t,o,n)=>Q(s,e,t,o,n).extend({responseFormat:yo.schema,responseSchema:uo.schema});var Co=(s,e,t,o,n)=>ne(s,e,t,o,n).extend({reasoningEnabled:Ae.schema}),To=(s,e,t,o,n)=>U(T({},te(s,e,t,o,n)),{reasoningEnabled:Ae.def});var ze=s=>provider.RangeConfigItem({param:"outputDimensionality",title:provider.EMBEDDING_CONFIG.DIMENSIONS.title,description:provider.EMBEDDING_CONFIG.DIMENSIONS.description,min:1,max:s,step:1,default:s});var bo=s=>zod.z.object({dimensions:ze(s).schema}),Go=s=>({dimensions:ze(s).def});var h={base:(s,e,t,o,n)=>({def:ee(s,e,t,o,n),schema:Q(s,e,t,o,n)}),responseSchema:(s,e,t,o,n)=>({def:te(s,e,t,o,n),schema:ne(s,e,t,o,n)}),reasoning:(s,e,t,o,n)=>({def:To(s,e,t,o,n),schema:Co(s,e,t,o,n)})},j={base:s=>({def:Go(s),schema:bo(s)})};var yt="google",$=class{constructor(){this.version="v1";this.name=yt;this.chatModelFactories={[ie]:{model:se,modelOptions:Po,modelSchema:He},[ae]:{model:re,modelOptions:Eo,modelSchema:Ke},[le]:{model:me,modelOptions:So,modelSchema:Ye},[de]:{model:pe,modelOptions:Ro,modelSchema:Ve},[ce]:{model:ge,modelOptions:Oo,modelSchema:Je},[he]:{model:fe,modelOptions:xo,modelSchema:We},[ue]:{model:ye,modelOptions:wo,modelSchema:Xe},[Ce]:{model:Te,modelOptions:ko,modelSchema:Ze},[Me]:{model:be,modelOptions:vo,modelSchema:Qe},[Ge]:{model:_e,modelOptions:No,modelSchema:eo},[Pe]:{model:Ee,modelOptions:Io,modelSchema:oo}};this.embeddingModelFactories={[to]:{model:Se,modelOptions:Fo,modelSchema:no},[io]:{model:Re,modelOptions:Do,modelSchema:so}};}chatModelLiterals(){return Object.keys(this.chatModelFactories)}chatModelSchemas(){return Object.keys(this.chatModelFactories).reduce((e,t)=>(e[t]=this.chatModelFactories[t].modelSchema,e),{})}chatModel(e){let t=e.modelName;if(!(t in this.chatModelFactories))throw new provider.ProviderError({info:`Google chat model: ${t} not found`,cause:new Error(`Google chat model: ${t} not found, available chat models: 
          [${this.chatModelLiterals().join(", ")}]`)});let o=this.chatModelFactories[t].model,n=this.chatModelFactories[t].modelOptions.parse(e);return new o(n)}embeddingModelLiterals(){return Object.keys(this.embeddingModelFactories)}embeddingModelSchemas(){return Object.keys(this.embeddingModelFactories).reduce((e,t)=>(e[t]=this.embeddingModelFactories[t].modelSchema,e),{})}embeddingModel(e){let t=e.modelName;if(!(t in this.embeddingModelFactories))throw new provider.ProviderError({info:`Google embedding model: ${t} not found`,cause:new Error(`Google embedding model: ${t} not found, available embedding models: 
          [${this.embeddingModelLiterals().join(", ")}]`)});let o=this.embeddingModelFactories[t].model,n=this.embeddingModelFactories[t].modelOptions.parse(e);return new o(n)}};$.baseUrl="https://generativelanguage.googleapis.com/v1beta";var u={"base-gemini-1-chat-model":{modelName:"base-gemini-1-chat-model",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:null,prices:{base:{inputPricePerMillion:0,outputPricePerMillion:0}}}]},"gemini-1.0-pro-001":{modelName:"gemini-1.0-pro-001",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:null,prices:{base:{inputPricePerMillion:.5,outputPricePerMillion:1.5}}}]},"gemini-1.0-pro-latest":{modelName:"gemini-1.0-pro-latest",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:null,prices:{base:{inputPricePerMillion:.5,outputPricePerMillion:1.5}}}]},"gemini-1.0-pro-vision":{modelName:"gemini-1.0-pro-vision",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:null,prices:{base:{inputPricePerMillion:.5,outputPricePerMillion:1.5}}}]},"gemini-1.0-pro":{modelName:"gemini-1.0-pro",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:null,prices:{base:{inputPricePerMillion:.5,outputPricePerMillion:1.5}}}]},"gemini-1.5-flash-001":{modelName:"gemini-1.5-flash-001",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:128e3,prices:{base:{inputPricePerMillion:.075,outputPricePerMillion:.3}}},{minTokens:128001,maxTokens:null,prices:{base:{inputPricePerMillion:.15,outputPricePerMillion:.6}}}]},"gemini-1.5-flash-002":{modelName:"gemini-1.5-flash-002",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:128e3,prices:{base:{inputPricePerMillion:.0375,outputPricePerMillion:.15}}},{minTokens:128001,maxTokens:null,prices:{base:{inputPricePerMillion:.075,outputPricePerMillion:.3}}}]},"gemini-1.5-flash-latest":{modelName:"gemini-1.5-flash-latest",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:128e3,prices:{base:{inputPricePerMillion:.075,outputPricePerMillion:.3}}},{minTokens:128001,maxTokens:null,prices:{base:{inputPricePerMillion:.15,outputPricePerMillion:.6}}}]},"gemini-1.5-flash":{modelName:"gemini-1.5-flash",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:128e3,prices:{base:{inputPricePerMillion:.075,outputPricePerMillion:.3}}},{minTokens:128001,maxTokens:null,prices:{base:{inputPricePerMillion:.15,outputPricePerMillion:.6}}}]},"gemini-1.5-pro-001":{modelName:"gemini-1.5-pro-001",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:128e3,prices:{base:{inputPricePerMillion:1.25,outputPricePerMillion:5}}},{minTokens:128001,maxTokens:null,prices:{base:{inputPricePerMillion:2.5,outputPricePerMillion:10}}}]},"gemini-1.5-pro-002":{modelName:"gemini-1.5-pro-002",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:128e3,prices:{base:{inputPricePerMillion:1.25,outputPricePerMillion:5}}},{minTokens:128001,maxTokens:null,prices:{base:{inputPricePerMillion:2.5,outputPricePerMillion:10}}}]},"gemini-1.5-pro-latest":{modelName:"gemini-1.5-pro-latest",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:128e3,prices:{base:{inputPricePerMillion:1.25,outputPricePerMillion:5}}},{minTokens:128001,maxTokens:null,prices:{base:{inputPricePerMillion:2.5,outputPricePerMillion:10}}}]},"gemini-1.5-pro":{modelName:"gemini-1.5-pro",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:128e3,prices:{base:{inputPricePerMillion:1.25,outputPricePerMillion:5}}},{minTokens:128001,maxTokens:null,prices:{base:{inputPricePerMillion:2.5,outputPricePerMillion:10}}}]},"gemini-2.0-flash-exp":{modelName:"gemini-2.0-flash-exp",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:null,prices:{base:{inputPricePerMillion:.1,outputPricePerMillion:.4}}}]},"gemini-2.5-flash-preview-04-17":{modelName:"gemini-2.5-flash-preview-04-17",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:null,prices:{base:{inputPricePerMillion:.15,outputPricePerMillion:.6}}}]},"gemini-2.5-pro-preview-03-25":{modelName:"gemini-2.5-pro-preview-03-25",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:2e5,prices:{base:{inputPricePerMillion:1.25,outputPricePerMillion:10}}},{minTokens:200001,maxTokens:null,prices:{base:{inputPricePerMillion:2.5,outputPricePerMillion:15}}}]},"gemini-pro-vision":{modelName:"gemini-pro-vision",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:null,prices:{base:{inputPricePerMillion:.5,outputPricePerMillion:1.5}}}]},"gemini-pro":{modelName:"gemini-pro",currency:"USD",tokenRanges:[{minTokens:0,maxTokens:null,prices:{base:{inputPricePerMillion:.5,outputPricePerMillion:1.5}}}]}};var M=zod.z.enum([types.SystemRoleLiteral,types.UserRoleLiteral,types.AssistantRoleLiteral,types.ToolRoleLiteral]),_t="model",Pt="function",b={system:types.UserRoleLiteral,user:types.UserRoleLiteral,assistant:_t,tool:Pt};var G=[types.TextModalityLiteral,types.ImageModalityLiteral,types.ToolCallModalityLiteral,types.ToolResponseModalityLiteral],_=zod.z.enum([types.TextModalityLiteral,types.ImageModalityLiteral,types.ToolCallModalityLiteral,types.ToolResponseModalityLiteral]),di=[types.TextModalityLiteral],pi=zod.z.enum([types.TextModalityLiteral]),ci=[types.TextModalityLiteral,types.ImageModalityLiteral],gi=zod.z.enum([types.TextModalityLiteral,types.ImageModalityLiteral]),hi=[types.TextModalityLiteral,types.ToolCallModalityLiteral,types.ToolResponseModalityLiteral],fi=zod.z.enum([types.TextModalityLiteral,types.ToolCallModalityLiteral,types.ToolResponseModalityLiteral]);var Et=zod.z.object({text:zod.z.string()}),St=zod.z.object({functionCall:zod.z.object({name:zod.z.string(),args:zod.z.record(zod.z.any())})}),Lo=zod.z.object({candidates:zod.z.array(zod.z.object({content:zod.z.object({role:zod.z.string(),parts:zod.z.array(zod.z.union([Et,St]))}).optional(),finishReason:zod.z.string(),index:zod.z.number().optional(),safetyRatings:zod.z.optional(zod.z.array(zod.z.object({category:zod.z.string(),probability:zod.z.string(),blocked:zod.z.boolean().optional()})))})),promptFeedback:zod.z.optional(zod.z.object({safetyRatings:zod.z.optional(zod.z.array(zod.z.object({category:zod.z.string(),probability:zod.z.string()})))})),usageMetadata:zod.z.object({promptTokenCount:zod.z.number(),cachedContentTokenCount:zod.z.number().optional(),candidatesTokenCount:zod.z.number().optional(),totalTokenCount:zod.z.number()}).optional()}),Rt=zod.z.object({text:zod.z.string()}),Ot=zod.z.object({functionCall:zod.z.object({name:zod.z.string(),args:zod.z.record(zod.z.any())})}),ro=zod.z.object({candidates:zod.z.array(zod.z.object({content:zod.z.object({role:zod.z.string(),parts:zod.z.array(zod.z.union([Rt,Ot]))}).optional(),finishReason:zod.z.string().optional(),index:zod.z.number().optional(),safetyRatings:zod.z.optional(zod.z.array(zod.z.object({category:zod.z.string(),probability:zod.z.string(),blocked:zod.z.boolean().optional()})))})),promptFeedback:zod.z.optional(zod.z.object({safetyRatings:zod.z.optional(zod.z.array(zod.z.object({category:zod.z.string(),probability:zod.z.string()})))})),usageMetadata:zod.z.object({promptTokenCount:zod.z.number().optional(),cachedContentTokenCount:zod.z.number().optional(),candidatesTokenCount:zod.z.number().optional(),totalTokenCount:zod.z.number().optional()}).optional()});var Bo=zod.z.object({text:zod.z.string().min(1)}),xt=zod.z.object({inline_data:zod.z.object({mime_type:zod.z.string().min(1),data:zod.z.string().base64()})}),wt=zod.z.object({function_call:zod.z.object({name:zod.z.string().min(1),args:zod.z.record(zod.z.string().min(1))})}),kt=zod.z.object({function_response:zod.z.object({name:zod.z.string().min(1),response:zod.z.record(zod.z.string().min(1))})}),vt=zod.z.object({role:zod.z.enum(["user","model","function"]),parts:zod.z.array(zod.z.union([Bo,xt,wt,kt]))}),$o=zod.z.object({parts:zod.z.array(Bo)}),Nt=zod.z.object({name:zod.z.string().min(1),description:zod.z.string().min(1),parameters:zod.z.any()}),Uo=zod.z.object({function_calling_config:zod.z.object({mode:zod.z.enum(["ANY","AUTO","NONE"]),allowed_function_names:zod.z.array(zod.z.string()).optional()})}),jo=zod.z.object({stopSequences:zod.z.array(zod.z.string()).optional(),maxOutputTokens:zod.z.number().optional(),temperature:zod.z.number().optional(),topP:zod.z.number().optional(),topK:zod.z.number().optional(),presencePenalty:zod.z.number().optional(),frequencyPenalty:zod.z.number().optional(),seed:zod.z.number().optional()}),qo=zod.z.object({category:zod.z.enum(["HARM_CATEGORY_HARASSMENT","HARM_CATEGORY_HATE_SPEECH","HARM_CATEGORY_SEXUALLY_EXPLICIT","HARM_CATEGORY_DANGEROUS_CONTENT","HARM_CATEGORY_CIVIC_INTEGRITY"]),threshold:zod.z.enum(["HARM_BLOCK_THRESHOLD_UNSPECIFIED","BLOCK_LOW_AND_ABOVE","BLOCK_MEDIUM_AND_ABOVE","BLOCK_ONLY_HIGH","BLOCK_NONE","OFF"])}),Ao=zod.z.object({model:zod.z.string().min(1).optional(),contents:zod.z.array(vt),systemInstruction:$o.optional(),system_instruction:$o.optional(),generationConfig:jo.optional(),generation_config:jo.optional(),safetySettings:zod.z.array(qo).optional(),safety_settings:zod.z.array(qo).optional(),tools:zod.z.object({function_declarations:zod.z.array(Nt)}).optional(),toolConfig:Uo.optional(),tool_config:Uo.optional()});var C=zod.z.object({modelName:zod.z.string(),apiKey:zod.z.string(),baseUrl:zod.z.string().url().optional(),completeChatUrl:zod.z.string().url().optional(),streamChatUrl:zod.z.string().url().optional()}),y=class{constructor(e,t){this.version="v1";var n;let o=C.parse(t);this.modelSchema=e,this.modelName=o.modelName,this.apiKey=o.apiKey,this.baseUrl=provider.urlWithoutTrailingSlash((n=o.baseUrl)!=null?n:$.baseUrl),this.completeChatUrl=provider.urlWithoutTrailingSlash(o.completeChatUrl||`${this.baseUrl}/models/${this.modelName}:generateContent?key=${this.apiKey}`),this.streamChatUrl=provider.urlWithoutTrailingSlash(o.streamChatUrl||`${this.baseUrl}/models/${this.modelName}:streamGenerateContent?key=${this.apiKey}`);}getDefaultBaseUrl(){return this.baseUrl}getDefaultHeaders(){return {"Content-Type":"application/json"}}getDefaultParams(){return {}}getRetryDelay(e){return {shouldRetry:!1,delayMs:0}}getTokenCount(e){return e.reduce((t,o)=>t+o.content.map(n=>n.modality==="text"?n.value:"").join(" ").length,0)}transformModelRequest(e){let t=Ao.safeParse(e);if(!t.success)throw new provider.InvalidModelRequestError({info:"Invalid model request",cause:t.error});let o=t.data,n=o.model;if(o.system_instruction&&o.systemInstruction)throw new provider.InvalidModelRequestError({info:`Invalid model request for model : '${this.modelName}'`,cause:new Error("'system_instruction' and 'systemInstruction' are not allowed at the same time")});if(o.generation_config&&o.generationConfig)throw new provider.InvalidModelRequestError({info:`Invalid model request for model : '${this.modelName}'`,cause:new Error("'generation_config' and 'generationConfig' are not allowed at the same time")});if(o.tool_config&&o.toolConfig)throw new provider.InvalidModelRequestError({info:`Invalid model request for model : '${this.modelName}'`,cause:new Error("'tool_config' and 'toolConfig' are not allowed at the same time")});let a=o.system_instruction||o.systemInstruction,l=o.generation_config||o.generationConfig,i=o.safety_settings||o.safetySettings,m=o.tool_config||o.toolConfig;if(m&&(!o.tools||o.tools.function_declarations.length===0))throw new provider.InvalidModelRequestError({info:`Invalid model request for model : '${this.modelName}'`,cause:new Error("'tools' are required when 'tool_choice' is specified")});let r={};m&&(m.function_calling_config.mode==="ANY"&&m.function_calling_config.allowed_function_names&&m.function_calling_config.allowed_function_names.length===1?r.toolChoice=m.function_calling_config.allowed_function_names[0]:r.toolChoice=m.function_calling_config.mode.toLowerCase()),r.seed=l==null?void 0:l.seed,r.maxTokens=l==null?void 0:l.maxOutputTokens,r.temperature=l==null?void 0:l.temperature,r.topP=l==null?void 0:l.topP,r.presencePenalty=l==null?void 0:l.presencePenalty,r.frequencyPenalty=l==null?void 0:l.frequencyPenalty,r.stop=l==null?void 0:l.stopSequences,r.safetySettings=i;let p=types.Config().parse(provider.removeUndefinedEntries(r)),g=[];a&&a.parts.forEach(f=>{g.push({role:types.SystemRoleLiteral,content:[{modality:types.TextModalityLiteral,value:f.text}]});}),o.contents.forEach(f=>{let x=f.role;switch(x){case"user":{let k=f.parts.map(E=>"text"in E?{modality:types.TextModalityLiteral,value:E.text}:{modality:types.ImageModalityLiteral,detail:"auto",value:{type:types.Base64ImageContentTypeLiteral,base64:E.inline_data.data,mediaType:E.inline_data.mime_type.split("/")[1]}});g.push({role:x,content:k});}break;case"model":{let k=f.parts.map((E,N)=>"text"in E?{modality:types.TextModalityLiteral,value:E.text}:{modality:types.ToolCallModalityLiteral,id:N.toString(),index:N,name:E.function_call.name,arguments:JSON.stringify(E.function_call.args)});g.push({role:types.AssistantRoleLiteral,content:k});}break;case"function":{let k=f.parts.map((E,N)=>({modality:types.ToolResponseModalityLiteral,id:N.toString(),index:N,name:E.function_response.name,data:JSON.stringify(E.function_response.response)}));g.push({role:types.ToolRoleLiteral,content:k});}break;default:throw new provider.InvalidMessagesError({info:`Invalid message 'role' for model : ${this.modelName}`,cause:new Error(`role : '${f.role}' is not supported for model : ${this.modelName}`)})}});let P=[];return o.tools&&o.tools.function_declarations.forEach(f=>{P.push({type:"function",definition:{schema:{name:f.name,description:f.description,parameters:f.parameters}}});}),{modelName:n,config:p,messages:g,tools:P.length>0?P:void 0}}transformConfig(e,t,o){let n=e.toolChoice;delete e.toolChoice;let a=this.modelSchema.config.schema.safeParse(e);if(!a.success)throw new provider.InvalidConfigError({info:`Invalid config for model : '${this.modelName}'`,cause:a.error});let l=a.data;Object.keys(l).forEach(p=>{if(!(p in this.modelSchema.config.def))throw new provider.InvalidConfigError({info:`Invalid config for model : '${this.modelName}'`,cause:new Error(`Invalid config key : '${p}', 
            available keys : [${Object.keys(this.modelSchema.config.def).join(", ")}]`)})});let i=Object.keys(l).reduce((p,g)=>{let P=this.modelSchema.config.def[g],f=P.param,x=l[g];return g==="reasoningEnabled"?p.thinkingConfig={includeThoughts:x}:g==="maxReasoningTokens"?p.thinkingConfig=p.thinkingConfig&&typeof p.thinkingConfig=="object"?U(T({},p.thinkingConfig),{thinkingBudget:x}):{thinkingBudget:x}:f==="maxOutputTokens"&&P.type==="range"&&x===0?p[f]=P.max:p[f]=x,p},{}),m=i.safetySettings;delete i.safetySettings;let r;if(n!==void 0){let p=n;if(!o||o&&o.length===0)throw new provider.InvalidConfigError({info:`Invalid config for model : '${this.modelName}'`,cause:new Error("'tools' are required when 'toolChoice' is specified")});if(o&&o.length>0){let g=this.modelSchema.config.def.toolChoice;if(g.choices.includes(p))p==="any"?r={function_calling_config:{mode:"ANY",allowed_function_names:o.map(P=>P.definition.schema.name)}}:r={function_calling_config:{mode:p.toUpperCase()}};else if(o.map(P=>P.definition.schema.name).includes(p))r={function_calling_config:{mode:"ANY",allowed_function_names:[p]}};else throw new provider.InvalidConfigError({info:`Invalid config for model : '${this.modelName}'`,cause:new Error(`toolChoice : '${p}' is not part of provided 'tools' names or 
                one of [${g.choices.join(", ")}]`)})}}if("response_format"in i&&i.response_format!==void 0){let p=i.response_format;if(p==="json_schema"){let g=i.response_schema;if(!("response_schema"in i)||!i.response_schema||!(g!=null&&g.schema))throw new provider.InvalidConfigError({info:`Invalid config for model : '${this.modelName}'`,cause:new Error("'responseSchema' is required in config when 'responseFormat' is 'json_schema'")});i.responseSchema=g.schema,i.responseMimeType="application/json","additionalProperties"in g.schema&&delete i.responseSchema.additionalProperties,delete i.response_format,delete i.response_schema;}else p==="json_object"?(i.responseSchema={type:"object"},delete i.response_format):p==="text"&&delete i.response_format;}return T(T({generation_config:i},r?{tool_config:r}:{}),m?{safety_settings:m}:{})}transformMessages(e){if(!e||e&&e.length===0)return {messages:[]};let t=i=>{let m=i.match(/^data:image\/[a-zA-Z]+;base64,/);return m?i.substring(m[0].length):i},o=e.map(i=>{let m=types.Message().safeParse(i);if(!m.success)throw new provider.InvalidMessagesError({info:"Invalid messages",cause:m.error});return m.data});o.forEach(i=>{i.content.forEach(m=>{if(!this.modelSchema.modalities.includes(m.modality))throw new provider.InvalidMessagesError({info:`Invalid message content for model : '${this.modelName}'`,cause:new Error(`model : '${this.modelName}' does not support modality : '${m.modality}', 
              available modalities : [${this.modelSchema.modalities.join(", ")}]`)})});}),o.forEach(i=>{if(!Object.keys(this.modelSchema.roles).includes(i.role))throw new provider.InvalidMessagesError({info:`Invalid message content for model : '${this.modelName}'`,cause:new Error(`model : '${this.modelName}' does not support role : '${i.role}', 
            available roles : [${Object.keys(this.modelSchema.roles).join(", ")}]`)})});let n={parts:[]},a=[];if(o.forEach(i=>{switch(i.role){case types.SystemRoleLiteral:i.content.forEach(m=>{if(m.modality===types.TextModalityLiteral)n.parts.push({text:m.value});else throw new provider.InvalidMessagesError({info:`Invalid message 'role' and 'modality' combination for model : ${this.modelName}`,cause:new Error(`role : '${i.role}' cannot have content with modality : '${m.modality}'`)})});break;case types.AssistantRoleLiteral:{let m=[];i.content.forEach(r=>{if(r.modality===types.TextModalityLiteral)m.push({text:r.value});else if(r.modality===types.ToolCallModalityLiteral)m.push({function_call:{name:r.name,args:JSON.parse(r.arguments)}});else throw new provider.InvalidMessagesError({info:`Invalid message 'role' and 'modality' combination for model : ${this.modelName}`,cause:new Error(`role : '${i.role}' cannot have content with modality : '${r.modality}'`)})}),a.push({role:this.modelSchema.roles[i.role],parts:m});}break;case types.UserRoleLiteral:{let m=[];i.content.forEach(r=>{if(r.modality===types.TextModalityLiteral)m.push({text:r.value});else if(r.modality===types.ImageModalityLiteral){if(r.value.type==="base64"){let p=r.value.base64;p=t(p),m.push({inline_data:{mime_type:`image/${r.value.mediaType}`,data:p}});}else if(r.value.type==="url")throw new provider.InvalidMessagesError({info:`Invalid message 'modality' for model : ${this.modelName}`,cause:new Error(`model: '${this.modelName}' does not support image content type: '${r.value.type}'`)})}else throw new provider.InvalidMessagesError({info:`Invalid message 'role' and 'modality' combination for model : ${this.modelName}`,cause:new Error(`role : '${i.role}' cannot have content with modality : '${r.modality}'`)})}),a.push({role:this.modelSchema.roles[i.role],parts:m});}break;case types.ToolRoleLiteral:{let m=[];i.content.forEach(r=>{if(r.modality===types.ToolResponseModalityLiteral)m.push({function_response:{name:r.name,response:JSON.parse(r.data)}});else throw new provider.InvalidMessagesError({info:`Invalid message 'role' and 'modality' combination for model : ${this.modelName}`,cause:new Error(`role : '${i.role}' cannot have content with modality : '${r.modality}'`)})}),a.push({role:this.modelSchema.roles[i.role],parts:m});}break;default:throw new provider.InvalidMessagesError({info:`Invalid message 'role' for model : ${this.modelName}`,cause:new Error(`role : '${i.role}' is not supported, 
              available roles : [${Object.keys(this.modelSchema.roles).join(", ")}]`)})}}),a[0].role!==this.modelSchema.roles[types.UserRoleLiteral])throw new provider.InvalidMessagesError({info:`Invalid message 'role' for model : ${this.modelName}`,cause:new Error(`model : '${this.modelName}' requires first message to be from user`)});let l=i=>i===this.modelSchema.roles[types.UserRoleLiteral]||i===this.modelSchema.roles[types.ToolRoleLiteral]?[this.modelSchema.roles[types.AssistantRoleLiteral]]:[this.modelSchema.roles[types.UserRoleLiteral],this.modelSchema.roles[types.ToolRoleLiteral]];for(let i=1;i<a.length;i++)if(!l(a[i-1].role).includes(a[i].role))throw new provider.InvalidMessagesError({info:`Invalid message format for model : ${this.modelName}`,cause:new Error(`model : '${this.modelName}' cannot have message with role : '${a[i].role}' after message with role : '${a[i-1].role}'`)});if(a[a.length-1].role!==this.modelSchema.roles[types.UserRoleLiteral]&&a[a.length-1].role!==this.modelSchema.roles[types.ToolRoleLiteral])throw new provider.InvalidMessagesError({info:`Invalid message format for model : ${this.modelName}`,cause:new Error(`model : '${this.modelName}' requires last message to be from user`)});return T({contents:a},n.parts.length>0?{system_instruction:n}:{})}transformTools(e){if(!this.modelSchema.modalities.includes(types.ToolCallModalityLiteral))throw new provider.InvalidToolsError({info:`Invalid tool 'modality' for model : ${this.modelName}`,cause:new Error(`model : '${this.modelName}' does not support tool modality : '${types.ToolCallModalityLiteral}'`)});return !e||e&&e.length===0?{tools:[]}:{tools:[{function_declarations:e.map(n=>{let a=types.Tool().safeParse(n);if(!a.success)throw new provider.InvalidToolsError({info:"Invalid tools",cause:a.error});return a.data}).map(n=>({name:n.definition.schema.name,description:n.definition.schema.description,parameters:n.definition.schema.parameters}))}]}}getCompleteChatUrl(e,t,o){return R(this,null,function*(){return new Promise(n=>{n(this.completeChatUrl);})})}getCompleteChatHeaders(e,t,o){return R(this,null,function*(){return new Promise(n=>{n(this.getDefaultHeaders());})})}getCompleteChatData(e,t,o){return R(this,null,function*(){let n=this.transformConfig(e,t,o),a=this.transformMessages(t);if(a.messages&&a.messages.length===0)throw new provider.InvalidMessagesError({info:"Messages are required",cause:new Error("Messages are required")});let l=o?this.transformTools(o):{};return new Promise(i=>{i(T(T(T(T({},this.getDefaultParams()),n),a),l));})})}transformCompleteChatResponse(e){let t=Lo.safeParse(e);if(t.success){if(t.data.candidates.length===0)throw new provider.ModelResponseError({info:"Invalid response from model",cause:new Error(`No choices in response : ${JSON.stringify(t.data)}`)});let o=t.data,n=[],a,l=o.candidates[0].content;if(l){let r=l.parts.map((p,g)=>{if("text"in p&&p.text!==void 0)return types.createTextContent(p.text);if("functionCall"in p&&p.functionCall!==void 0)return types.createToolCallContent(g,`${p.functionCall.name}_${g}`,p.functionCall.name,JSON.stringify(p.functionCall.args))});return n.push({role:types.AssistantRoleLiteral,content:r}),o.usageMetadata&&(a={promptTokens:o.usageMetadata.promptTokenCount,totalTokens:o.usageMetadata.totalTokenCount,completionTokens:o.usageMetadata.candidatesTokenCount||0}),{messages:n,usage:a,logProbs:void 0}}let i=o.candidates[0].safetyRatings;if(i&&i.length>0&&i.forEach(r=>{if(r.blocked)throw new provider.ModelResponseError({info:`Blocked content for category: ${r.category} with probability: ${r.probability}`,cause:new Error(`Blocked content for category: ${r.category} with probability: ${r.probability}`)})}),o.candidates[0].finishReason==="SAFETY")throw new provider.ModelResponseError({info:"Blocked content, model response finished with safety reason",cause:new Error("Blocked content, model response finished with safety reason")})}throw new provider.ModelResponseError({info:"Invalid response from model",cause:t.error})}getStreamChatUrl(e,t,o){return R(this,null,function*(){return new Promise(n=>{n(this.streamChatUrl);})})}getStreamChatHeaders(e,t,o){return R(this,null,function*(){return new Promise(n=>{n(this.getDefaultHeaders());})})}getStreamChatData(e,t,o){return R(this,null,function*(){let n=this.transformConfig(e,t,o),a=this.transformMessages(t);if(a.messages&&a.messages.length===0)throw new provider.InvalidMessagesError({info:"Messages are required",cause:new Error("Messages are required")});let l=o?this.transformTools(o):{};return new Promise(i=>{i(T(T(T(T({},this.getDefaultParams()),n),a),l));})})}transformStreamChatResponseChunk(e,t){return De(this,null,function*(){let o=(t+e).split(",\r").filter(n=>n.trim()!=="");for(let n of o){let a=n;if(a=a.replace(/\n/g,""),a.startsWith("[")||a.startsWith(",{"))a=a.slice(1);else if(a.endsWith("]")){if(a==="]")return;a=a.slice(0,-1);}let l;try{l=JSON.parse(a);}catch(m){if(m instanceof SyntaxError){t=a;continue}else throw m}t="";let i=ro.safeParse(l);if(i.success){let m={partialMessages:[]},r=i.data;if(r.candidates.length>0){let p=r.candidates[0].content;p&&"parts"in p&&p.parts.length>0&&p.parts.forEach((g,P)=>{if("text"in g&&g.text!==void 0&&m.partialMessages.push(types.createPartialTextMessage(types.AssistantRoleLiteral,g.text)),"functionCall"in g&&g.functionCall!==void 0){let f=g.functionCall;m.partialMessages.push(types.createPartialToolCallMessage(types.AssistantRoleLiteral,P,`${f.name}_${P}`,f.name,JSON.stringify(f.args)));}});}r.usageMetadata&&(m.usage={promptTokens:r.usageMetadata.promptTokenCount,completionTokens:r.usageMetadata.candidatesTokenCount,totalTokens:r.usageMetadata.totalTokenCount}),yield {partialResponse:m,buffer:t};}else throw new provider.ModelResponseError({info:"Invalid response from model",cause:i.error})}yield {partialResponse:{partialMessages:[]},buffer:t};})}transformProxyStreamChatResponseChunk(e,t,o,n,a){return De(this,null,function*(){if((a==null?void 0:a.alt)!=="sse"){yield*fo(this.transformStreamChatResponseChunk(e,t));return}let l=t+e,i=[],m="",r=0;for(;r<l.length;){let p=l.indexOf(`
`,r);if(p===-1){m=l.substring(r);break}else {let g=l.substring(r,p).trim();g&&i.push(g),r=p+1;}}for(let p of i){if(p==="data: [DONE]")return;if(p.startsWith("data: ")){let g=p.substring(6);try{let P=JSON.parse(g),f=ro.safeParse(P);if(f.success){let x={partialMessages:[]},w=f.data;if(w.candidates.length>0){let k=w.candidates[0].content;k&&"parts"in k&&k.parts.length>0&&k.parts.forEach((E,N)=>{if("text"in E&&E.text!==void 0&&x.partialMessages.push(types.createPartialTextMessage(types.AssistantRoleLiteral,E.text)),"functionCall"in E&&E.functionCall!==void 0){let Fe=E.functionCall;x.partialMessages.push(types.createPartialToolCallMessage(types.AssistantRoleLiteral,N,`${Fe.name}_${N}`,Fe.name,JSON.stringify(Fe.args)));}});}w.usageMetadata&&w.usageMetadata.totalTokenCount&&w.usageMetadata.promptTokenCount&&w.usageMetadata.candidatesTokenCount&&(x.usage={promptTokens:w.usageMetadata.promptTokenCount,completionTokens:w.usageMetadata.candidatesTokenCount,totalTokens:w.usageMetadata.totalTokenCount}),yield {partialResponse:x,buffer:t};}else throw new provider.ModelResponseError({info:"Invalid response from model",cause:f.error})}catch(P){throw new provider.ModelResponseError({info:`Malformed JSON received in stream: ${g}`,cause:P})}}}yield {partialResponse:{partialMessages:[]},buffer:m};})}getProxyCompleteChatUrl(e,t,o){return R(this,null,function*(){return new Promise(n=>{n(this.completeChatUrl);})})}getProxyStreamChatUrl(e,t,o){return R(this,null,function*(){return new Promise(n=>{if(!o||Object.keys(o).length===0){n(this.streamChatUrl);return}let a=new URL(this.streamChatUrl);Object.entries(o).forEach(([l,i])=>{i!=null&&a.searchParams.set(l,i);}),n(a.toString());})})}getProxyCompleteChatHeaders(e,t,o){return R(this,null,function*(){if(!t)return {};let n=T({},t);return delete n.host,delete n["content-length"],n})}getProxyStreamChatHeaders(e,t,o){return R(this,null,function*(){return yield this.getProxyCompleteChatHeaders(e,t,o)})}getModelPricing(){if(!(this.modelName in u))throw new provider.ModelResponseError({info:`Invalid model pricing for model : '${this.modelName}'`,cause:new Error(`No pricing configuration found for model "${this.modelName}"`)});return u[this.modelName]}};var ie="gemini-1.5-flash-001",Bt="Google's fastest, most cost-efficient multimodal model with great performance for high-frequency tasks.   Optimized for fast and versatile performance across a diverse variety of tasks",He=provider.ChatModelSchema(M,_).parse({name:ie,description:Bt,maxInputTokens:1e6,maxOutputTokens:8192,roles:b,modalities:G,config:{def:h.responseSchema(2,1,8192,4,.95).def,schema:h.responseSchema(2,1,8192,4,.95).schema},price:u[ie]}),Po=C,se=class extends y{constructor(e){super(He,e);}};var ae="gemini-1.5-flash-002",zt="Google's fastest, most cost-efficient multimodal model with great performance for high-frequency tasks.   Optimized for fast and versatile performance across a diverse variety of tasks",Ke=provider.ChatModelSchema(M,_).parse({name:ae,description:zt,maxInputTokens:1e6,maxOutputTokens:8192,roles:b,modalities:G,config:{def:h.responseSchema(2,1,8192,4,.95).def,schema:h.responseSchema(2,1,8192,4,.95).schema},price:u[ae]}),Eo=C,re=class extends y{constructor(e){super(Ke,e);}};var le="gemini-1.5-flash-latest",Kt="Google's latest multimodal model with great performance for high-frequency tasks.   Optimized for fast and versatile performance across a diverse variety of tasks",Ye=provider.ChatModelSchema(M,_).parse({name:le,description:Kt,maxInputTokens:1e6,maxOutputTokens:8192,roles:b,modalities:G,config:{def:h.responseSchema(2,1,8192,4,.95).def,schema:h.responseSchema(2,1,8192,4,.95).schema},price:u[le]}),So=C,me=class extends y{constructor(e){super(Ye,e);}};var de="gemini-1.5-flash",Vt="Google's fastest, most cost-efficient multimodal model with great performance for high-frequency tasks.   Optimized for fast and versatile performance across a diverse variety of tasks",Ve=provider.ChatModelSchema(M,_).parse({name:de,description:Vt,maxInputTokens:1e6,maxOutputTokens:8192,roles:b,modalities:G,config:{def:h.responseSchema(2,1,8192,4,.95).def,schema:h.responseSchema(2,1,8192,4,.95).schema},price:u[de]}),Ro=C,pe=class extends y{constructor(e){super(Ve,e);}};var ce="gemini-1.5-pro-001",Wt="Google's best performing multimodal model with features for a wide variety of reasoning tasks.   Optimized for complex reasoning tasks requiring more intelligence",Je=provider.ChatModelSchema(M,_).parse({name:ce,description:Wt,maxInputTokens:2e6,maxOutputTokens:8192,roles:b,modalities:G,config:{def:h.responseSchema(2,1,8192,4,.95).def,schema:h.responseSchema(2,1,8192,4,.95).schema},price:u[ce]}),Oo=C,ge=class extends y{constructor(e){super(Je,e);}};var he="gemini-1.5-pro-002",Zt="Google's best performing multimodal model with features for a wide variety of reasoning tasks.   Optimized for complex reasoning tasks requiring more intelligence",We=provider.ChatModelSchema(M,_).parse({name:he,description:Zt,maxInputTokens:2e6,maxOutputTokens:8192,roles:b,modalities:G,config:{def:h.responseSchema(2,1,8192,4,.95).def,schema:h.responseSchema(2,1,8192,4,.95).schema},price:u[he]}),xo=C,fe=class extends y{constructor(e){super(We,e);}};var ue="gemini-1.5-pro-latest",en="Google's best performing multimodal model with features for a wide variety of reasoning tasks.   Optimized for complex reasoning tasks requiring more intelligence",Xe=provider.ChatModelSchema(M,_).parse({name:ue,description:en,maxInputTokens:2e6,maxOutputTokens:8192,roles:b,modalities:G,config:{def:h.responseSchema(2,1,8192,4,.95).def,schema:h.responseSchema(2,1,8192,4,.95).schema},price:u[ue]}),wo=C,ye=class extends y{constructor(e){super(Xe,e);}};var Ce="gemini-1.5-pro",tn="Google's best performing multimodal model with features for a wide variety of reasoning tasks.   Optimized for complex reasoning tasks requiring more intelligence",Ze=provider.ChatModelSchema(M,_).parse({name:Ce,description:tn,maxInputTokens:2e6,maxOutputTokens:8192,roles:b,modalities:G,config:{def:h.responseSchema(2,1,8192,4,.95).def,schema:h.responseSchema(2,1,8192,4,.95).schema},price:u[Ce]}),ko=C,Te=class extends y{constructor(e){super(Ze,e);}};var Me="gemini-2.0-flash-exp",sn="Google's experimental multimodal model with enhanced capabilities.   Designed for cutting-edge performance across complex and high-frequency tasks.",Qe=provider.ChatModelSchema(M,_).parse({name:Me,description:sn,maxInputTokens:1e6,maxOutputTokens:8192,roles:b,modalities:G,config:{def:h.responseSchema(2,1,8192,4,.95).def,schema:h.responseSchema(2,1,8192,4,.95).schema},price:u[Me]}),vo=C,be=class extends y{constructor(e){super(Qe,e);}};var Ge="gemini-2.5-flash-preview-04-17",rn="Google's best model in Gemini 2.5 family in terms of price-performance, offering well-rounded capabilities.",eo=provider.ChatModelSchema(M,_).parse({name:Ge,description:rn,maxInputTokens:1048576,maxOutputTokens:65536,roles:b,modalities:G,config:{def:h.responseSchema(2,1,65536,4,.95).def,schema:h.responseSchema(2,1,65536,4,.95).schema},price:u[Ge]}),No=C,_e=class extends y{constructor(e){super(eo,e);}};var Pe="gemini-2.5-pro-preview-03-25",mn="Google's preview model in Gemini 2.5 family for enhanced thinking, reasoning, multimodal understanding, and advanced coding.",oo=provider.ChatModelSchema(M,_).parse({name:Pe,description:mn,maxInputTokens:1048576,maxOutputTokens:65536,roles:b,modalities:G,config:{def:h.reasoning(2,1,65536,4,.95).def,schema:h.reasoning(2,1,65536,4,.95).schema},price:u[Pe]}),Io=C,Ee=class extends y{constructor(e){super(oo,e);}};var Ne=[types.EmbeddingTextModalityLiteral],Ie=zod.z.enum([types.EmbeddingTextModalityLiteral]);var Xo=zod.z.object({embeddings:zod.z.array(zod.z.object({values:zod.z.array(zod.z.number())}))});var pn=zod.z.object({model:zod.z.string().min(1),content:zod.z.object({parts:zod.z.array(zod.z.object({text:zod.z.string().min(1)})).min(1)})}),Zo=zod.z.object({model:zod.z.string().min(1).optional(),requests:zod.z.array(pn).min(1),outputDimensionality:zod.z.number().int().min(1).optional()});var W=zod.z.object({modelName:zod.z.string(),apiKey:zod.z.string(),baseUrl:zod.z.string().url().optional(),getEmbeddingsUrl:zod.z.string().url().optional()}),A=class{constructor(e,t){this.version="v1";let o=W.parse(t);this.modelSchema=e,this.modelName=o.modelName,this.apiKey=o.apiKey,this.baseUrl=provider.urlWithoutTrailingSlash(o.baseUrl||$.baseUrl),this.getEmbeddingsUrl=provider.urlWithoutTrailingSlash(o.getEmbeddingsUrl||`${this.baseUrl}/models/${this.modelName}:batchEmbedContents?key=${this.apiKey}`);}getDefaultBaseUrl(){return this.baseUrl}getDefaultHeaders(){return {"Content-Type":"application/json"}}getDefaultParams(){return {model:this.modelName}}getRetryDelay(e){return {shouldRetry:!1,delayMs:0}}getTokenCount(e){return e.requests.reduce((t,o)=>t+o.length,0)}transformModelRequest(e){let t=Zo.safeParse(e);if(!t.success)throw new provider.InvalidModelRequestError({info:"Invalid model request",cause:t.error});let o=t.data,n=o.model,a={outputDimensionality:o.outputDimensionality},l=types.Config().parse(provider.removeUndefinedEntries(a)),i={modality:types.EmbeddingTextModalityLiteral,requests:o.requests.reduce((m,r)=>(m.push(...r.content.parts.map(p=>p.text)),m),[])};return {modelName:n,config:l,embeddingRequests:i}}transformConfig(e,t){let o=this.modelSchema.config.schema.safeParse(e);if(!o.success)throw new provider.InvalidConfigError({info:`Invalid config for model : '${this.modelName}'`,cause:o.error});let n=o.data;return Object.keys(n).forEach(l=>{if(!this.modelSchema.config.def[l])throw new provider.InvalidConfigError({info:`Invalid config for model : '${this.modelName}'`,cause:new Error(`Invalid config key : '${l}', 
            available keys : [${Object.keys(this.modelSchema.config.def).join(", ")}]`)})}),Object.keys(n).reduce((l,i)=>{let r=this.modelSchema.config.def[i].param,p=n[i];return l[r]=p,l},{})}transformEmbeddingRequests(e){let t=types.EmbeddingRequests().safeParse(e);if(!t.success)throw new provider.InvalidEmbeddingRequestsError({info:"Invalid embedding requests",cause:t.error});if(e.modality!==types.EmbeddingTextModalityLiteral)throw new provider.InvalidEmbeddingRequestsError({info:`Invalid embedding requests for model : '${this.modelName}'`,cause:new Error(`Only '${types.EmbeddingTextModalityLiteral}' modality is supported for model : '${this.modelName}'`)});return {requests:t.data.requests.map(n=>({model:`models/${this.modelName}`,content:{parts:[{text:n}]}}))}}getGetEmbeddingsUrl(e,t){return R(this,null,function*(){return new Promise(o=>{o(this.getEmbeddingsUrl);})})}getGetEmbeddingsHeaders(e,t){return R(this,null,function*(){return new Promise(o=>{o(this.getDefaultHeaders());})})}getGetEmbeddingsData(e,t){return R(this,null,function*(){return new Promise(o=>{let n=this.transformConfig(e),a=this.transformEmbeddingRequests(t);if(t.requests.length===0)throw new provider.InvalidEmbeddingRequestsError({info:`Invalid embedding requests for model : '${this.modelName}'`,cause:new Error("requests cannot be empty")});n.outputDimensionality&&(a.requests.forEach(l=>{l.outputDimensionality=n.outputDimensionality;}),delete n.outputDimensionality),o(T(T(T({},this.getDefaultParams()),n),a));})})}transformGetEmbeddingsResponse(e){let t=Xo.safeParse(e);if(t.success){let n=t.data.embeddings.map((a,l)=>({index:l,embedding:a.values}));return {encodingFormat:types.FloatEmbeddingLiteral,embeddings:n}}throw new provider.ModelResponseError({info:"Invalid response from model",cause:t.error})}};var to="text-embedding-001",Tn="text-embedding-001",no=provider.EmbeddingModelSchema(Ie).parse({name:to,description:Tn,modalities:Ne,maxInputTokens:2048,maxOutputTokens:768,config:{def:j.base(768).def,schema:j.base(768).schema}}),Fo=W,Se=class extends A{constructor(e){super(no,e);}};var io="text-embedding-004",bn="text-embedding-004",so=provider.EmbeddingModelSchema(Ie).parse({name:io,description:bn,modalities:Ne,maxInputTokens:2048,maxOutputTokens:768,config:{def:j.base(768).def,schema:j.base(768).schema}}),Do=W,Re=class extends A{constructor(e){super(so,e);}};

exports.BaseChatModel = y;
exports.BaseChatModelOptions = C;
exports.BaseEmbeddingModel = A;
exports.BaseEmbeddingModelOptions = W;
exports.ChatModelBaseConfigDef = ee;
exports.ChatModelBaseConfigSchema = Q;
exports.ChatModelReasoningConfigDef = To;
exports.ChatModelReasoningConfigSchema = Co;
exports.EmbeddingModelBaseConfigDef = Go;
exports.EmbeddingModelBaseConfigSchema = bo;
exports.Gemini1_5Flash = pe;
exports.Gemini1_5Flash001 = se;
exports.Gemini1_5Flash001Literal = ie;
exports.Gemini1_5Flash001Options = Po;
exports.Gemini1_5Flash001Schema = He;
exports.Gemini1_5Flash002 = re;
exports.Gemini1_5Flash002Literal = ae;
exports.Gemini1_5Flash002Options = Eo;
exports.Gemini1_5Flash002Schema = Ke;
exports.Gemini1_5FlashLatest = me;
exports.Gemini1_5FlashLatestLiteral = le;
exports.Gemini1_5FlashLatestOptions = So;
exports.Gemini1_5FlashLatestSchema = Ye;
exports.Gemini1_5FlashLiteral = de;
exports.Gemini1_5FlashOptions = Ro;
exports.Gemini1_5FlashSchema = Ve;
exports.Gemini1_5Pro = Te;
exports.Gemini1_5Pro001 = ge;
exports.Gemini1_5Pro001Literal = ce;
exports.Gemini1_5Pro001Options = Oo;
exports.Gemini1_5Pro001Schema = Je;
exports.Gemini1_5Pro002 = fe;
exports.Gemini1_5Pro002Literal = he;
exports.Gemini1_5Pro002Options = xo;
exports.Gemini1_5Pro002Schema = We;
exports.Gemini1_5ProLatest = ye;
exports.Gemini1_5ProLatestLiteral = ue;
exports.Gemini1_5ProLatestOptions = wo;
exports.Gemini1_5ProLatestSchema = Xe;
exports.Gemini1_5ProLiteral = Ce;
exports.Gemini1_5ProOptions = ko;
exports.Gemini1_5ProSchema = Ze;
exports.Gemini2_0FlashExp = be;
exports.Gemini2_0FlashExpLiteral = Me;
exports.Gemini2_0FlashExpOptions = vo;
exports.Gemini2_0FlashExpSchema = Qe;
exports.Gemini2_5FlashPreview0417 = _e;
exports.Gemini2_5FlashPreview0417Literal = Ge;
exports.Gemini2_5FlashPreview0417Options = No;
exports.Gemini2_5FlashPreview0417Schema = eo;
exports.Gemini2_5ProPreview0325 = Ee;
exports.Gemini2_5ProPreview0325Literal = Pe;
exports.Gemini2_5ProPreview0325Options = Io;
exports.Gemini2_5ProPreview0325Schema = oo;
exports.Google = $;
exports.GoogleChatAssistantRoleLiteral = _t;
exports.GoogleChatContent = vt;
exports.GoogleChatContentPartFunctionCall = wt;
exports.GoogleChatContentPartFunctionResponse = kt;
exports.GoogleChatContentPartInlineData = xt;
exports.GoogleChatContentPartText = Bo;
exports.GoogleChatGenerationConfig = jo;
exports.GoogleChatModelConfigs = h;
exports.GoogleChatModelModalities = G;
exports.GoogleChatModelModalitiesEnum = _;
exports.GoogleChatModelResponseSchemaConfigDef = te;
exports.GoogleChatModelResponseSchemaConfigSchema = ne;
exports.GoogleChatModelRoles = M;
exports.GoogleChatModelRolesMap = b;
exports.GoogleChatModelTextModalities = di;
exports.GoogleChatModelTextModalitiesEnum = pi;
exports.GoogleChatModelTextToolModalities = hi;
exports.GoogleChatModelTextToolModalitiesEnum = fi;
exports.GoogleChatModelTextVisionModalities = ci;
exports.GoogleChatModelTextVisionModalitiesEnum = gi;
exports.GoogleChatRequest = Ao;
exports.GoogleChatSafetySettings = qo;
exports.GoogleChatSystemInstruction = $o;
exports.GoogleChatTool = Nt;
exports.GoogleChatToolConfig = Uo;
exports.GoogleChatToolRoleLiteral = Pt;
exports.GoogleCompleteChatResponse = Lo;
exports.GoogleCompleteChatTextResponse = Et;
exports.GoogleCompleteChatToolResponse = St;
exports.GoogleEmbeddingModelConfigs = j;
exports.GoogleEmbeddingModelModalities = Ne;
exports.GoogleEmbeddingModelModalitiesEnum = Ie;
exports.GoogleEmbeddingRequest = Zo;
exports.GoogleEmbeddingRequestInput = pn;
exports.GoogleGetEmbeddingsResponse = Xo;
exports.GoogleStreamChatResponse = ro;
exports.GoogleStreamChatTextResponse = Rt;
exports.GoogleStreamChatToolResponse = Ot;
exports.ProviderLiteral = yt;
exports.Text_Embedding_001 = Se;
exports.Text_Embedding_001Literal = to;
exports.Text_Embedding_001Options = Fo;
exports.Text_Embedding_001Schema = no;
exports.Text_Embedding_004 = Re;
exports.Text_Embedding_004Literal = io;
exports.Text_Embedding_004Options = Do;
exports.Text_Embedding_004Schema = so;
exports.dimensions = ze;
exports.frequencyPenalty = Sn;
exports.maxTokens = $e;
exports.presencePenalty = Rn;
exports.reasoningEnabled = Ae;
exports.safetySettings = Be;
exports.seed = On;
exports.stop = Ue;
exports.temperature = Le;
exports.toolChoice = qe;
exports.topK = En;
exports.topP = je;
//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map